function mutatedNetwork = Mutate(originalNetwork,mutationProbability,...
        creepMutationParameter)

originalInputToHidden = originalNetwork{1};
originalHiddenToOutput = originalNetwork{2};
mutatedInputToHidden = originalInputToHidden;
mutatedHiddenToOutput = originalHiddenToOutput;

for i = 1:size(originalInputToHidden,1)
  for j = 1:size(originalInputToHidden,2)
    originalWeight = originalInputToHidden(i,j);
    r = rand;
    creepMutation = -creepMutationParameter+2*r*creepMutationParameter;
    mutatedWeight = originalWeight + creepMutation;
    mutatedInputToHidden(i,j) = mutatedWeight;
  end
end

for i = 1:size(weightsHiddenToOutput1,1)
  for j = 1:size(weightsHiddenToOutput1,2)
    weight1 = weightsHiddenToOutput1(i,j);
    weight2 = weightsHiddenToOutput2(i,j);
    alpha = minAlpha + rand*deltaAlpha; % ALSO TRY SAMPLING OUTSIDE THE LOOP!

    newWeight = weight1 + alpha*(weight2-weight1);
    offspringHiddenToOutput(i,j) = newWeight;
  end
end
    
    
    
    
    
    
    
nGenes = size(chromosome,2);
mutatedChromosome = chromosome;

for j = 1:nGenes
  r = rand;
  if (r < mutationProbability)
    mutatedChromosome(j) = 1-chromosome(j);
  end
end

end

